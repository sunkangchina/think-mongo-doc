(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{287:function(t,n,e){"use strict";e.r(n);var i=e(13),r=Object(i.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"远程调用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#远程调用"}},[t._v("#")]),t._v(" 远程调用")]),t._v(" "),n("p",[t._v("如调用webtool")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$url = get_config(\"RPC_WEBTOOL_URL\").'/rpc/webtool/PrinterLianke';   \n$client = rpc($url);  \n$info = $client->get_info([\n    'device_id'=>$input['key1'],\n    'device_key'=>$input['key2'],\n]); \n")])])]),n("p",[t._v("在 "),n("code",[t._v("RPC_WEBTOOL_URL")]),t._v(" 项目下有"),n("code",[t._v("app\\webtool\\rpc\\PrinterLianke")]),t._v("\n当 "),n("code",[t._v("RPC_WEBTOOL_URL")]),t._v(" 值不存在时，请复制 "),n("code",[t._v("app")]),t._v("下的"),n("code",[t._v("webtool")]),t._v("目录至发起调用的项目中，将自动不再发起"),n("code",[t._v("RPC")]),t._v("请求而改用本地调用，无需修改代码。")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("<?php \n/*\n    授权许可说明请阅读LICENSE.md\n    获取授权方式: yiiphp@foxmail.com \n*/ \nnamespace app\\webtool\\rpc; \nuse app\\webtool\\service\\PrinterLianke as Service;\n/**\n* /rpc/webtool/PrinterLianke\n* 具体查看API接口参数\n* \n$url = 'http://tool/rpc/webtool/PrinterLianke';\n$client = rpc_client($url); \n$info = $client->get_info([\n    'device_id'=>'lc01cy08508343',\n    'device_key'=>'P1vTZ4pLAxa7wBF8',\n]);  \n\n*/\nclass PrinterLianke extends Service{    \n}\n")])])]),n("p",[t._v("service 具体实现")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("<?php \n/*\n    授权许可说明请阅读LICENSE.md\n    获取授权方式: yiiphp@foxmail.com \n*/ \nnamespace app\\webtool\\service; \nuse app\\webtool\\classes\\PrinterLianke as Printer;\n \nclass PrinterLianke{  \n\tprotected $printer; \n\tpublic    $device_id; \n\tpublic    $device_key; \n\t/**\n\t* 初始化\n\t* 具体查看API接口参数\n\t* @return object\n\t*/\n\tpublic function init($device_id,$device_key,$debug = false){\n\t\t$this->printer = new Printer($device_id,$device_key,$debug);\n\t\t$this->device_id = $device_id;\n\t\t$this->device_key = $device_key;\n\t\treturn $this;\n\t}\n\n\tprotected function _init($arr = []){\n\t\tif(!$this->device_id){\n\t\t\t$device_id = $arr['device_id'];\n\t\t\t$device_key = $arr['device_key'];\n\t\t\t$debug = $arr['debug'];\n\t\t\tif(!$device_id || !$device_key){\n\t\t\t\tthrow new \\Exception(\"请求异常\", 403);\t\t\t\t\n\t\t\t}\n\t\t\t$this->printer = new Printer($device_id,$device_key,$debug);\n\t\t}\n\t}\n\n\t/**\n\t* 获取端口信息-在线掉线\n\t*/\n\tpublic function get_info($opt = []){   \n\t\t$this->_init($opt); \n\t\treturn $this->printer->get_info();\n\t}\n\n\t/**\n\t* 获取端口下打印机列表\n\t*/\n\tpublic function get_printer_list($opt = []){ \n\t\t$this->_init($opt);\n\t\treturn $this->printer->get_printer_list();\n\t}\n\n\t/**\n\t* 获取某个打印机参数\n\t*/\n\tpublic function get_printer_par($opt = [],$printer_model){ \n\t\t$this->_init($opt);\n\t\treturn $this->printer->get_printer_par($printer_model);\n\t}\n\n\t/**\n\t* 提交打印任务\n\t*/\n\tpublic function add_job($opt = [],$printerModel, $file, $optional_array){ \n\t\t$this->_init($opt);\n\t\treturn $this->printer->add_job($printerModel, $file, $optional_array);\n\t}\n\n\t/**\n\t* 获取打印任务状态\n\t*/\n\tpublic function get_job($opt = [],$device_port,$task_id){ \n\t\t$this->_init($opt);\n\t\treturn $this->printer->get_job($device_port,$task_id);\n\t}\n\n\t/**\n\t* 取消打印任务\n\t*/\n\tpublic function cancel_job($opt = [],$device_port,$task_id){ \n\t\t$this->_init($opt);\n\t\treturn $this->printer->cancel_job($device_port,$task_id);\n\t}\n}\n")])])])])}),[],!1,null,null,null);n.default=r.exports}}]);